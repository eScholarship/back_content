{% extends "admin/core/base.html" %}
{% load static %}

{% block title %}Back Content Submission{% endblock %}


{% block breadcrumbs %}
    {{ block.super }}
    <li><a href="{% url 'bc_index' %}">Back Content Plugin</a></li>
    <li>{% if article %}{{ article.safe_title }}{% else %}New Article{% endif %}</li>
{% endblock breadcrumbs %}

{% block body %}
<section class="content">
    <div class="row expanded">
        <div class="large-12 columns box">
            <form method="POST">
                {% csrf_token %}
                {% if deposit_form %}
                <div class="title-area">
                    <h2>Deposit Agreement</h2>
                </div>
                <div class="submission-content large-12 columns">
                    {{ deposit_form }}
                </div>
                {% endif %}
                <div class="title-area">
                    <h2>Article Metadata</h2>
                </div>
                <div class="submission-content">
                    <div class="large-12 columns">
                        <label for="id_title">{% trans "Title" %}</label>
                        {{ article_form.title }}
                        {{ article_form.title.errors }}
                    </div>
                    {% if article_form.subtitle %}
                    <div class="large-12 columns">
                        <label for="id_subtitle">{% trans "Subtitle" %}</label>
                        {{ article_form.subtitle }}
                        {{ article_form.subtitle.errors }}
                    </div>
                    {% endif %}
                    <div class="large-12 columns">
                        <label for="id_abstract">
                            {% trans "Abstract" %}{% if form.abstract.field.required %}*{% endif %}</label>
                        {{ article_form.abstract }}
                        {{ article_form.abstract.errors }}
                    </div>
                    <div class="large-4 columns">
                        <label for="id_language">{% trans "Language" %}</label>
                        {{ article_form.language }}
                        {{ article_form.language.errors }}
                    </div>
                    <div class="large-4 columns">
                        <label for="id_section">{% trans "Section" %}</label>
                        {{ article_form.section }}
                        {{ article_form.section.errors }}
                    </div>
                    <div class="large-4 columns error">
                        <label for="id_license">{% if article_form.license.errors %}
                            <span style="color: red;">{% endif %}{% trans "License" %}
                            {% if article_form.license.errors %}</span>{% endif %}
                            {% if article_form.license.field.required %}*{% endif %}</label>
                        {{ article_form.license }}
                        {{ article_form.license.errors }}
                    </div>
                    <div class="large-12 columns">
                        <label for="id_keywords">Keywords</label>
                        <input type="text" id="id_keywords" name="keywords" value="
                                {% if article_form.cleaned_data.keywords %}
                                    {{ article_form.cleaned_data.keywords }}
                                {% else %}
                                    {% for keyword in article.keywords.all %}
                                        {{ keyword.word }}
                                        {% if not forloop.last %},{% endif %}
                                    {% endfor %}
                                {% endif %}"/>
                        Hit Enter to add a new keyword.
                    </div>
                </div>

                {% include "admin/elements/submission/additional_fields.html" with form=article_form additional_fields=additional_fields %}

                <div class="pull-right">
                    <button class="success button" type="submit" name="save_close">
                        <i class="fa fa-close">&nbsp;</i>Save & Close
                    </button>
                    <button class="success button" type="submit" name="save_continue">
                        <i class="fa fa-arrow-right">&nbsp;</i>Save & Continue
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>
{% endblock body %}

{% block js %}
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <script type="text/javascript" src="{% static "common/js/jq-ui.min.js" %}"></script>
    <script src="{% static "common/js/tagit.js" %}"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#id_keywords").tagit(
                {allowSpaces: true});
        });
    </script>
{% endblock js %}
