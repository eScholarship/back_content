{% extends "admin/core/base.html" %}

{% block title %}Back Content Submission - Add Authors{% endblock %}


{% block breadcrumbs %}
    {{ block.super }}
    <li><a href="{% url 'bc_index' %}">Back Content Plugin</a></li>
    <li>{{ article.safe_title }}</li>
{% endblock breadcrumbs %}

{% block body %}
<section class="content">
    <div class="row expanded">
        <div class="large-12 columns box">
            <div class="title-area">
                <h2>Article Authors</h2>
            </div>
            <div class="content" data-equalizer data-equalize-on="medium">
                <div class="large-7 columns" data-equalizer-watch>
                    <p>{% trans "You can add an author by clicking the button below. This will open a popup modal for you to complete their details. If you do not have a legitimate email address for this author use @journal.com as a prefix for their email address and Janeway will ignore it." %}</p>
                    <a href="#" data-open="author" class="small success button">{% trans "Add New Author" %}</a>
                    {% include "admin/elements/submit/author.html" %}
                    <p>{% trans "If you know of an existing author, you can search for them." %}</p>
                    <a href="{% url 'bc_article_authors' article.pk %}" class="small success button">Search Accounts for Authors</a>
                </div>
                <div class="large-5 columns" data-equalizer-watch>
                    <h4>{% trans "Current Authors" %}</h4>
                    <div class="row">
                        <form method="POST">
                            {% csrf_token %}
                            <table class="small scroll">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>{% trans "Name" %}</th>
                                    <th>{% trans "Email" %}</th>
                                    <th></th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody id="sortable">
                                {% for order in article.articleauthororder_set.all %}
                                    <tr id="authors-{{ order.author.pk }}">
                                        <td><i class="fa fa-sort"></i></td>
                                        <td>{{ order.author.full_name }}</td>
                                        <td>{{ order.author.email }}</td>
                                        <td>
                                            <button name="set_main" value="{{ order.author.pk }}" class="tiny button">Set as Main</button>
                                        </td>
                                        <td>
                                            <button name="remove_author" value="{{ order.author.pk }}" class="tiny alert button">Remove</button>
                                        </td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="3">{% trans "No authors yet, add one!" %}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </form>
                        <hr/>
                        <form method="POST">
                            {% csrf_token %}
                            <p>{% trans "You are required to select a main author, this author will receive the communications regarding your articles process through our systems. This does not have to be you." %}</p>
                            <label for="main-author">{% trans "Select main author" %}:</label>
                            <select class="form-control" id="main-author" name="main-author" required>
                                <option value="">---------</option>
                                {% for author in article.authors.all %}
                                    <option value="{{ author.pk }}"
                                            {% if article.correspondence_author.pk == author.pk %}selected{% endif %}>{{ author.full_name }}</option>
                                {% endfor %}
                            </select>
                            <div class="pull-right">
                                <button class="success button" type="submit" name="back">
                                    <i class="fa fa-arrow-left">&nbsp;</i>Back
                                </button>
                                <button class="success button" type="submit" name="close">
                                    <i class="fa fa-close">&nbsp;</i>Close
                                </button>
                                <button class="success button" type="submit" name="continue">
                                    <i class="fa fa-arrow-right">&nbsp;</i>Continue
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock body %}
